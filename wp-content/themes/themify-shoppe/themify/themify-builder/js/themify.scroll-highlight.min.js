'use strict';var themifyScrollHighlight=function(c,d,r){c.fn.themifyScrollHighlight=function(a){};var g=!1,m=c(d),p=!1,l=null,h=0;return{defaults:{speed:parseInt(tbScrollHighlight.speed),prefix:".tb_section-",navigation:tbScrollHighlight.navigation,context:"body",element:".module_row",scrollRate:250,considerHeader:!1,fixedHeaderHeight:0,updateHash:!0,scroll:"internal"},scrolling:!1,cleanupURL:function(a){return a.replace(/#.*$/,"").replace(/\/$/,"")},requestInterval:function(a,f){var b=(new Date).getTime();
d.requestAnimationFrame(function n(){var c=(new Date).getTime();c-b>=f&&(a.call(),b=c);d.requestAnimationFrame(n)})},cleanHash:function(a){return decodeURIComponent(a instanceof c?a.prop("hash"):a)},updateOffset:function(a){var c=parseInt(themify_vars.scrollTo);return c?Math.ceil(a-c):Math.ceil(a-this.options.fixedHeaderHeight+h)},setHeaderHeight:function(){if(Themify.body[0].classList.contains("fixed-header")){var a=c("#headerwrap");if(0!==a.length){a=a.clone();a.find("*").add(a).css("cssText","transition: all 0s ease 0s !important;");
a.removeClass("fixed-header").css({visibility:"hidden",left:"-10000px"}).appendTo("body");this.options.fixedHeaderHeight=a.outerHeight(!0);a.addClass("fixed-header");var f=a.css("background-image"),b=a.css("background-color");b&&-1<b.indexOf("rgba")&&(b=b.replace(/^.*,(.+)\)/,"$1").trim(),b=0===parseFloat(b)?"transparent":1);h="transparent"!==b||f&&"none"!==f?this.options.fixedHeaderHeight-a.outerHeight(!0):this.options.fixedHeaderHeight=0;a.remove()}}},highlightLink:function(a){var f=this;this.dehighlightLinks();
if(""!=a){var b=c(this.options.navigation).find('a[href*="'+a+'"]');b.length&&b.each(function(){var b=c(this);f.cleanHash(b)===a&&(b.parent().addClass("current_page_item"),Themify.body.triggerHandler("scrollhighlight.themify",[a]))})}},dehighlightLinks:function(){c(this.options.navigation).find('a[href*="#"]').each(function(){var a=this.parentNode;a.classList.remove("current_page_item");a.classList.remove("current-menu-item")})},isInViewport:function(a){if(!(a instanceof c&&"offset"in a))return!1;
var f=m.scrollTop()+(this.options.fixedHeaderHeight-h),b=f+m.height()/4,d=this.updateOffset(a.offset().top);a=d+a.height();return d<=b&&a>=f},isHash:function(a){return a&&"#"!==a},removeHash:function(){this.isCorrectHash()&&this.isHash(d.top.location.hash)&&(d.top.history.replaceState("",r.title,d.top.location.pathname+d.top.location.search),this.dehighlightLinks())},changeHash:function(a){if(!l||"#"!==a&&a!==this.cleanHash(d.location.hash))this.options.updateHash&&d.top.history.replaceState(null,
null,a),this.highlightLink(a),g=!1},isCorrectHash:function(){var a=location.hash.slice(1);return!(""==a||-1!==a.indexOf("!"))},linkScroll:function(a,f){var b=a.replace(this.options.prefix,"#");a=c(a);if(1<a.length&&(a=a.filter(":visible").first(),0===a.length&&(a=a.first(),0===a.length))){g=!1;return}a=a.get(0);Themify.body.triggerHandler("scrollhighlightstart.themify",[b]);b=c(a).offset().top;b=0>b?c(a.parentNode).offset().top:b;this.scrolling=!1;p=!0;"internal"===this.options.scroll?(Themify.body[0].classList.contains("fixed-header")&&
!Themify.body[0].classList.contains("header-bottom")&&(b=this.updateOffset(b)),Themify.scrollTo(b,+this.options.speed,function(){p=g=!1})):(g=!1,this.changeHash(f))},manualScroll:function(a){this.scrolling=!1;if(m.scrollTop()<this.options.fixedHeaderHeight)this.removeHash();else{for(var c=0,b=a.length;c<b;++c){var d=a[c];if(d.data("anchor")&&this.isInViewport(d)){d.data("hideAnchor")?this.highlightLink("#"+d.data("anchor")):this.changeHash("#"+d.data("anchor"));l=d;break}}l?this.isInViewport(l)||
(this.removeHash(),l=null):g=!1}},init:function(a){function f(a,b){return/touch/.test(a.type)?(a.originalEvent||a).changedTouches[0]["page"+b]:a["page"+b]}var b=this,h=[];this.options=c.extend({},b.defaults,a);if(!Themify.is_builder_active&&(c("div[class*="+b.options.prefix.replace(".","")+"]:visible,.module[id]:visible").not(b.options.exclude).each(function(){h.push(c(this))}),!h.length))return;b.setHeaderHeight();var n,q;c(this.options.context).on("touchstart.themifyScroll",'a[href*="#"], area[href*="#"]',
function(a){a.stopPropagation();n=f(a,"X");q=f(a,"Y")}).on("click.themifyScroll touchend.themifyScroll",'a[href*="#"], area[href*="#"]',function(a){if((!/touch/.test(a.type)||20>Math.abs(f(a,"X")-n)&&20>Math.abs(f(a,"Y")-q))&&this.host===d.location.host&&this.pathname===d.location.pathname&&!1===g&&!this.classList.contains("ab-item")){var e=b.cleanHash(c(this));if("#"!==e&&""!==e){e=-1!=e.indexOf("/")?e.substring(0,e.indexOf("/")):e;var h=e.replace(/#/,b.options.prefix),k=c(h);1>k.length&&null==this.closest(".tab-nav")&&
(k=c(e+".module,.module-tab "+e).first(),h=e);0<k.length&&(a.preventDefault(),a.stopPropagation(),g=!0,b.linkScroll(h,e),Themify.is_builder_active&&(l=!0,b.changeHash(e)))}}});Themify.is_builder_active||(m.on("scroll",function(){b.scrolling=!0}),this.requestInterval(function(){!p&&b.scrolling&&b.manualScroll(h)},b.options.scrollRate),m.on("load hashchange",function(a){if(!1===g)if(g=!0,b.isHash(d.location.hash)){var e=b.cleanHash(d.location.hash),f=!1;a=b.cleanupURL(d.location.href);a=c(b.options.context).find('a[href="'+
e+'"], a[href="'+a+e+'"], a[href="'+a+"/"+e+'"]');if(a.length)a.each(function(){var a=c(this);b.cleanHash(a)===e&&(f=!0,setTimeout(function(){g=!1;a.trigger("click.themifyScroll")},600))}),!1===f&&(g=!1);else{var k=e.replace(/#/,b.options.prefix);-1===k.search("/")&&c(k).length?setTimeout(function(){b.linkScroll(k,e)},600):g=!1}}else g=!1,b.manualScroll(h)}));c(d).load(function(){setTimeout(function(){b.setHeaderHeight()},1E4)})}}}(jQuery,window,document);
